---
discussionID: 4VRzUDnXN1BHHx8QIV1zE
tags:
 - rust
---

# Rust

- Rust
  - 设计理念
    - 内存安全、并发安全、性能
    - 多范式编程
    - 划分 Safe rust 和 Unsafe Rust（方便与其他语言沟通）
  - [Rust 编程基础](#rust-编程基础)
  - 进阶
    - [Rust 错误处理](./Rust%20错误处理.md)
    - 泛型编程
      - 数据结构的泛型
      - 使用泛型结构代码的泛型化
    - 面向接口编程
      - 接口将调用者和实现者隔离开，大大促进了代码的复用和扩展。面向接口编程可以让系统变得灵活，但是当使用接口去引用具体的类型时，在运行时变量原本的类型被抹去，我们无法单纯从一个指针分析出这个引用具备什么样的能力，所以我们就需要虚表来辅助运行时代码的执行。有了虚表，我们可以很方便地进行动态分派，它是运行时多态的基础。
      - Trait
    - 函数式编程
      - 函数往往是一等公民
      - 闭包是将函数，或者说代码和其环境一起存储的一种数据结构。闭包引用的上下文中的自由变量，会被捕获到闭包的结构中，成为闭包类型的一部分。
    - 并发编程
      - 并发是系统拥有同时与多件事情打交道的能力；并行是同时处理多件事情的手段  ![图 17](./images/1653375009755.png)  
      - 异步编程
    - 宏编程
      - 声明宏
      - 过程宏
        - 函数宏
        - 派生宏
        - 属性宏
    - 面向对象编程
  - rustup：rust 开发管理工具
    - rustc：rust 编译器
    - cargo：rust 构建系统和包管理工具
      - 概念
        - package：项目
        - crate：库
        - workspace
      - 命令
        - build
        - run
        - check
  - 学习资料
    - [Rust编程语言入门教程（Rust语言/Rust权威指南配套）](https://www.bilibili.com/video/BV1hp4y1k7SV)

## Rust 编程基础

- 编程基础
  - 变量、值和类型声明
    - 变量
      - 变量声明：`let`
        - 默认不可变
        - 隐藏变量：即可重复声明变量
      - 可变变量声明：`let mut`
      - 常量声明：`const`
        - 不可与 `mut` 配合，且使用**必须注明值的类型**
        - 命名规范：大写，单词下划线分隔
    - 类型声明
      - rust 编译器会自动隐式**类型推导**，但特殊情况也需要表明数据类型，如 const 变量声明
    - 类型系统
      - 类型是对值的区分，它包含了值在内存中的长度、对齐以及值可以进行的操作等信息；值是无法脱离具体的类型讨论的
      - 内存分配
        - 栈上存放的数据是静态的，固定大小，固定生命周期
        - 堆上存放的数据是动态的，不固定大小，不固定生命周期
      - 分类
        - 标量类型
          - 整数
            - 无符号：`u32`
            - 有符号：`i32`
          - 浮点
            - IEEE-754 标准
          - 布尔
          - 字符
            - 单个字符：`char`
        - 复合类型
          - 结构体（struct）：多个类型组合在一起共同表达一个值的复杂数据结构
            - 元组：`let tup = (32, 'A', 0.12);`
              - 解构：`let (x, y, z) = tup;`
              - 索引：`tup.1`
            - 数组
              - 特点
                - 长度固定、类型相同
                - 存放栈内存
              - `[类型，长度]`：`let arr: [i32; 5] = [1,2,3,4,5];`
              - `let arr2 = [3; 5]; // let arr2 = [3,3,3,3,3]`
            - 结构体 `struct`
              - 默认可变
              - 使用字段初始化简写语法
              - 使用结构体更新语法从其他实例创建实例
              - 实现函数成员：`impl [Type] {...}`
                - 方法：以 self 为第一参数的函数
                - 关联函数（类似静态方法）：不以 self 为第一参数的函数
                  - 访问：`Xxx::method`
                - 自动引用和解引用机制：在调用方法时，Rust 会自动为对象添加 `&`、`&mut` 或 `*` 以便使 object 与方法签名匹配
            - 元组结构体：元组结构体有着结构体名称提供的含义，但没有具体的字段名，只有字段的类型，`struct Xxx(xxx, xxx, xxx)`
            - 单元结构体：可以定义一个没有任何字段的命名结构体
          - 枚举（enum）：联合标签
  - 语句、表达式与运算符
    - 语句是执行一些动作的指令，以分号";"结尾
    - 表达式会计算产生值
    - **面向表达式**：一切皆是表达式，即一切皆类型（表达式会产生值，值即类型，rust 就是通过一切类型检查保证内存安全、并发安全）
      - 分号也是一种表达式，`; -> ()`，返回单元类型
      - 块表达式会对最后表达式求值并返回
    - 控制流
      - 顺序
      - 循环
        - `loop {...}`：一直循环
        - `while(条件){...}`：条件循环
          - 总是返回 `()` 类型
        - `for ... in [迭代器] {...}`：集合迭代
        - 中断
          - `break [value]`
          - `continue`
          - `return [value]`
      - 分支 
        - `if [condition] {...} else {...}`
        - 模式匹配
          - `match expr {}`
          - `if let / while let`
      - 跳转
        - [错误处理](./Rust%20错误处理.md)
        - 异步跳转
  - 函数 `fn xxx_xxx([arg:type, ...]) -> [type]{...}`
    - 函数声明提升
    - 返回值
      - 默认最后一个表达式
      - `return`：指定返回值
    - 命名规范：Snake Case
  - [所有权、借用及生命周期](./所有权、借用及生命周期.md)
  - 模块系统：箱、模块、路径
    - 箱 crate：一个项目也被称为一个 crate，crate 可以是可执行项目，也可以是一个库
    - `pub`：导出
    - `use`：导入
  - 数据结构
    - 集合
      - 矢量 `Vec`
      - 哈希 `HashMap`
  - 注释
    - 文档注释
  - 调试
    - std::fmt::Display
      - {}
    - std::fmt::Debug
      - {:?}
      - #[derive(Debug)]
  - 测试
    - 单元测试
      - `#[test]`
      - `#[should_panic]` 预期的失败
      - `#[ignore]` 忽略测试
    - 文档测试 `///`
    - 集成测试
  - 宏
    - `#![...]`

## 自动引用和解引用机制

Rust 的自动引用和自动解引用机制是指编译器会在某些情况下自动地将一个值转换为一个引用或者解引用一个引用，以便匹配函数或方法的参数类型。