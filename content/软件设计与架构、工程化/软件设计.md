---
discussionID: bxt8N5Gy3XHPrUQIYylHm
release: true
tags:
 - 软件设计
 - 编程范式
---

# 软件设计

- 软件设计
  - 软件开发是为了解决需求问题，而**软件设计对抗的是不断增加的需求问题**
  - 需求包括两大类，第一类是功能性需求，也就是要业务功能；第二类是非功能性需求，是业务功能之外的一些需求  
    - 需求
      - 功能性需求
      - 非功能性需求
        - 执行质量
          - 正确性
          - 稳定性
          - 安全性
          - 高性能
        - 代码质量
          - 可测试性
          - 可维护性
            - 可复用性
            - 可扩展性
            - 可读性（语法规范之类）
  - 故在软件开发过程中就需要建立设计起一个统一的结构，以便于所有人都能有一个共同的理解。这就如同建筑中的图纸，懂建筑的人看了之后，就会产生一个统一的认识。而在软件的开发过程中，这种统一的结构就是**模型**，而**软件设计就是要构建出一套模型**。
  - 模型
    - 模型，不仅包括用来描述业务的各种实体，也包括完成业务功能的各种组件，或者抽象概念
    - 模型是一个软件的核心
      - 模型的粒度可大可小
      - 好的模型应该**高内聚、低耦合**
      - 模型可以**分层**，由底层的模型提供接口，构建出上层的模型
  - 规范：限定了什么样的需求应该以怎样的方式去完成
    - 比如模型可以反映到代码实现，但有时需要加以规范限制，比如 React Hooks 的限制性。
  - **软件设计 = 模型建立 + 规范设计**
  - 模型与规范，二者相辅相成：模型的实现需要规范限制，而规范的制定也有赖于模型
- 软件设计的方法，即如何建立模型
  - **分离关注点**：将一个模块的不同纬度分开
    - 关注点
      - 不同层次
      - 不同功能角色
      - 不同的数据变动方向：读写分离、动静分离
      - 变的部分与不变的部分
  - **可测试性**：可作为衡量设计优劣的一个重要标准，一个模块具有可测试性意味着设计模式上更优
    - 在集成测试过程往往是消耗是最大，一个最主要的方面原因是在集成测试前没有做好单测，即模块缺乏可测试性。模块缺乏可测试性，意味着模块在测试上有难度，这也造成集成测试消耗会更多测试时间
    - 要保证每个小模块的正确性，就要保证每个模块在开发阶段能够充分测试，而想要每个模块能够测试，在设计过程中，就要**保证每个模块是可以测试的**，而这就是可测试性
    - **保证可测试性：我们在设计过程中，必须将可测试性纳入考量，就是在设计时问一下，这个函数 / 模块 / 系统怎么测，以便于能够完成不同层次的测试，减少对集成环境的依赖**
      - 设计上保证可测试性
      - 尽可能本地环境上进行更多测试用例
- 如何了解一个软件的设计?
  1. 分层（模型是可分层的）
  2. 模型：理解一个模型的关键在于，要了解这个模型设计的来龙去脉，知道它是如何解决相应的问题
  3. 接口
     - 任何软件接口的数量都不是一个小数目，所以要学会找主要接口
     - 找主要接口方法：**找主线，看风格(学习其设计风格)**
     - 找主线看文档：找到项目主线的一个方法就是从起步走文档开始，因为它会把项目最基本的用法展现给你，你可以轻松地找到主线
  4. 实现
     - 理解一个实现，是以对模型和接口的理解为前提的
     - 每个软件的实现都有非常多的细节，如果想了解一个软件的实现。我们**从软件的结构和关键的技术入手，要带着自己的问题进行寻思**，问题的出发点就是我们对模型和接口的理解
     - 想要了解一个软件的实现，就要把分层的模型展开，看下一层的模型，即了解软件的结构（回到步骤1）
- 程序设计语言：从模型分层套娃来看，程序设计语言本身也是一个软件，它也包含模型、接口和实现
  - 模型：编程模型
    - 学习程序设计语言其实就是要**学习语言提供的编程模型**。语言的发展就是一个互相学习和借鉴的过程：每一种模型的提出的最大的动力是为了解决某个问题，新的语言新的语法通常是在既有的结构上不断添加出来的，为的是简化代码的编写。学习新语言，其实只是在做增量的学习，重点在差异化学习
    - 理解语言提供的编程模型后，要懂得**一切语法都是语法糖**，打开语法糖去了解其底层运行设计原理，即实现原理
  - 接口
    - 语法
    - 程序库：程序库也是程序设计语言的”接口”
      - 程序库最初只是为了消除重复，有一些程序库实在是太常用了，它们就会随着语言一起发布，成为**标准库**
      - 第三方程序库：第三方库、语言生态的兴起，怎样管理第三方库就成了一个问题，于是就有了**包管理器**
    - **“语言设计就是程序库设计”和“程序库设计就是语言设计”**
      - 语法和程序库是在解决同一个问题，二者之间是相互促进的关系。通常是先有程序库，再有语法；如果语法不够好，新的程序库就会出现，新一轮的编程模型就开始孵化，一个经过验证的模式最终变成了语言的一部分，而它的起点只是一个常见的用法：一个程序库
      - 学习一种程序设计语言提供的模型时，不仅仅要看语法本身有什么，还要了解有语言特性的一些程序库。一方面，我们可以锻炼自己从日常工作中寻找重复；另一方面，我们可以更好地理解程序设计语言提供的能力
      - **提升软件设计能力，可以从编写程序库入手**
  - 实现：即支撑程序运行的部分：运行时，也有人称之为运行时系统，或运行时环境，它主要是**为了实现程序设计语言的执行模型**
    - **运行时，是我们做软件设计的真正地基**：一些比较基础的设计，仅仅了解到语言这个层面是不够的。做设计真正的地基，并不是程序设计语言，而是运行时，有了对于运行时的理解，我们甚至可以做出语言本身不支持的设计
    - 学习运行时
      - 了解程序如何运行：带着“程序如何运行”这个问题去理解就好了
      - 运行时的编程接口
        - 语言层面的运行时编程接口
        - 通过了解指令的执行方式：开发者就可以利用这个指令改善自己的运行时实现
- [编程范式](#编程范式)
- 设计方法
  - 领域驱动设计
- 架构设计
  - 面向服务架构（service-oriented architecture，简称 SOA）

## 编程范式

> 编程语言的发展就是一个逐步远离计算机硬件，向着待解决的领域问题靠近的过程。从结构化编程到面向对象编程，再到函数式编程，离图灵机模型越来越远，但抽象程度越来越高，与领域问题的距离越来越近。

- 编程范式：指的是程序的编写模式，意味着主要使用的是什么样的代码结构
  - **编程范式的本质主要是对程序员的能力施加了约束**
  - 宏观上，编程语言可以大致分为两类，一类是命令式，一类是声明式：
    - 命令式：通过一系列顺序指令来告诉计算机怎么做
    - 声明式：只需要说明实现的目标，总而言之就是它是定义结果而不是定义步骤
  - 主流编程模型
    - 结构化编程，也称作过程式编程，或面向过程编程
      - 通过一些结构化的控制结构进行程序的构建
        - 顺序结构
        - 选择结构 if/switch/match 
        - 循环结构 for/while
      - 优点
        - 限制使用 goto 语句，它是**对程序控制权的直接转移施加了约束**
        - 限制 goto 后，带来**功能分解**的思想，即将模块按照功能进行拆分，将大问题拆分成可以解决的小问题
      - 缺点
        - 自定而下功能分解，这种结构下模块具有**强依赖性**、**抽象性不够**：一旦需求变动，经常是牵一发而动全身，关联的模块由于依赖关系的存在都需要变动，**无法有效隔离变化**
        - **可测试性不够**
    - [面向对象编程](./面向对象编程.md)
    - [函数式编程](./函数式编程.md)
  - **最佳实践**
    - 采用面向对象进行系统设计、程序模块组织
    - 采用函数式编程的风格指导类的接口设计
    - 接口具体的实现中使用结构化编程提供的控制结构

## 学习参考

- 极客专栏《软件设计之美》
- 《Clean Architecture》