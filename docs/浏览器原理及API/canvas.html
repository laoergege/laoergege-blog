<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Canvas 知识体系 | Laoergege Blog</title>
    <meta name="generator" content="VuePress 1.4.1">
    
    <meta name="description" content="Just For Fun">
    <link rel="preload" href="/assets/css/0.styles.7b9dec97.css" as="style"><link rel="preload" href="/assets/js/app.38b0ed3c.js" as="script"><link rel="preload" href="/assets/js/2.baa3e7d6.js" as="script"><link rel="preload" href="/assets/js/11.01908082.js" as="script"><link rel="prefetch" href="/assets/js/10.b5d3c059.js"><link rel="prefetch" href="/assets/js/12.6cebf715.js"><link rel="prefetch" href="/assets/js/13.99f1c706.js"><link rel="prefetch" href="/assets/js/14.de31b2b6.js"><link rel="prefetch" href="/assets/js/15.3d9cf311.js"><link rel="prefetch" href="/assets/js/16.55d48bb1.js"><link rel="prefetch" href="/assets/js/17.1c4258c4.js"><link rel="prefetch" href="/assets/js/18.c02aabe8.js"><link rel="prefetch" href="/assets/js/19.fde75ccc.js"><link rel="prefetch" href="/assets/js/20.873d8613.js"><link rel="prefetch" href="/assets/js/21.0478ee4e.js"><link rel="prefetch" href="/assets/js/22.92657552.js"><link rel="prefetch" href="/assets/js/23.b04f8d2f.js"><link rel="prefetch" href="/assets/js/24.7ec16b80.js"><link rel="prefetch" href="/assets/js/25.04593fe2.js"><link rel="prefetch" href="/assets/js/26.752c1492.js"><link rel="prefetch" href="/assets/js/27.2ad24ceb.js"><link rel="prefetch" href="/assets/js/28.f4196a0b.js"><link rel="prefetch" href="/assets/js/29.1fe777ef.js"><link rel="prefetch" href="/assets/js/3.24808612.js"><link rel="prefetch" href="/assets/js/30.fdc65bb8.js"><link rel="prefetch" href="/assets/js/31.38ab86ba.js"><link rel="prefetch" href="/assets/js/32.27438ef6.js"><link rel="prefetch" href="/assets/js/33.a3cf05bc.js"><link rel="prefetch" href="/assets/js/34.53e0b3ca.js"><link rel="prefetch" href="/assets/js/35.e62c79f4.js"><link rel="prefetch" href="/assets/js/36.32b1d8ea.js"><link rel="prefetch" href="/assets/js/37.71d93fc5.js"><link rel="prefetch" href="/assets/js/38.4efb45d5.js"><link rel="prefetch" href="/assets/js/39.61be1d03.js"><link rel="prefetch" href="/assets/js/4.353e6982.js"><link rel="prefetch" href="/assets/js/40.bcec9f92.js"><link rel="prefetch" href="/assets/js/41.914dfce5.js"><link rel="prefetch" href="/assets/js/42.07498b9a.js"><link rel="prefetch" href="/assets/js/43.047235c2.js"><link rel="prefetch" href="/assets/js/44.4ed4f205.js"><link rel="prefetch" href="/assets/js/45.7600397f.js"><link rel="prefetch" href="/assets/js/46.a36a6de7.js"><link rel="prefetch" href="/assets/js/47.cfe37dc7.js"><link rel="prefetch" href="/assets/js/48.4abeb832.js"><link rel="prefetch" href="/assets/js/49.6ce44ec6.js"><link rel="prefetch" href="/assets/js/5.63c3a223.js"><link rel="prefetch" href="/assets/js/6.0a015b77.js"><link rel="prefetch" href="/assets/js/7.1e31ca6f.js"><link rel="prefetch" href="/assets/js/8.431e35ed.js"><link rel="prefetch" href="/assets/js/9.2cfbb454.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7b9dec97.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Laoergege Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/JavaScript/" class="nav-link">
  JavaScript
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端框架及库" class="dropdown-title"><span class="title">前端框架及库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/React/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/RxJS/" class="nav-link">
  RxJS
</a></li></ul></div></div><div class="nav-item"><a href="/前端工程/" class="nav-link">
  前端工程
</a></div><div class="nav-item"><a href="/浏览器原理及API/" class="nav-link">
  浏览器原理及API
</a></div><div class="nav-item"><a href="/NodeJS/" class="nav-link">
  NodeJS
</a></div><div class="nav-item"><a href="/Git/" class="nav-link">
  Git
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/JavaScript/" class="nav-link">
  JavaScript
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端框架及库" class="dropdown-title"><span class="title">前端框架及库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/React/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/RxJS/" class="nav-link">
  RxJS
</a></li></ul></div></div><div class="nav-item"><a href="/前端工程/" class="nav-link">
  前端工程
</a></div><div class="nav-item"><a href="/浏览器原理及API/" class="nav-link">
  浏览器原理及API
</a></div><div class="nav-item"><a href="/NodeJS/" class="nav-link">
  NodeJS
</a></div><div class="nav-item"><a href="/Git/" class="nav-link">
  Git
</a></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="canvas-知识体系"><a href="#canvas-知识体系" class="header-anchor">#</a> Canvas 知识体系</h2> <ul><li>基础
<ul><li>开始
<ul><li>坐标系</li> <li>绘制路径</li></ul></li> <li>绘制图形</li> <li>样式和颜色</li> <li>绘制文本</li> <li>绘制图像</li> <li>变形</li></ul></li> <li>进阶
<ul><li>动画</li> <li>优化
<ul><li>Path2D 缓存或记录绘画指令</li></ul></li></ul></li> <li>常见问题
<ul><li>Canvas 高清适配</li> <li>Canvas 跨域</li></ul></li></ul> <h2 id="目录"><a href="#目录" class="header-anchor">#</a> 目录</h2> <ul><li><a href="#canvas-%E7%9F%A5%E8%AF%86%E4%BD%93%E7%B3%BB">Canvas 知识体系</a></li> <li><a href="#%E7%9B%AE%E5%BD%95">目录</a></li> <li><a href="#%E5%BC%80%E5%A7%8B">开始</a> <ul><li><a href="#%E5%9D%90%E6%A0%87%E7%B3%BB">坐标系</a></li> <li><a href="#%E7%BB%98%E5%88%B6%E8%B7%AF%E5%BE%84">绘制路径</a></li></ul></li> <li><a href="#%E7%BB%98%E5%88%B6%E5%9B%BE%E5%83%8F">绘制图像</a> <ul><li><a href="#%E8%A3%81%E5%89%AA%E5%90%88%E6%88%90">裁剪、合成</a></li></ul></li> <li><a href="#%E5%8A%A8%E7%94%BB">动画</a></li> <li><a href="#canvas-%E9%AB%98%E6%B8%85%E9%80%82%E9%85%8D">Canvas 高清适配</a></li></ul> <h2 id="开始"><a href="#开始" class="header-anchor">#</a> 开始</h2> <p>Canvas API 提供了一个通过JavaScript 和 HTML的 <code>&lt;canvas&gt;</code> 元素来绘制图形的方式，相比较浏览器 HTML 的渲染页面方式，Canvas 更像似更接近底层，使用绘制指令，在 canvas 区域绘制图像</p> <p>Canvas API 支持</p> <ul><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D" target="_blank" rel="noopener noreferrer">CanvasRenderingContext2D<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 接口的2D渲染</li> <li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/WebGL2RenderingContext" target="_blank" rel="noopener noreferrer">WebGL2RenderingContext<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 接口的硬件加速的 2D、3D 渲染</li></ul> <blockquote><p>本文主要以 CanvasRenderingContext2D 渲染为主</p></blockquote> <p>Canvas 基本模板骨架</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">function</span> <span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'tutorial'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>canvas<span class="token punctuation">.</span>getContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            ctx<span class="token punctuation">.</span>fillColor <span class="token operator">=</span> <span class="token string">'yellow'</span>
            ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
    <span class="token selector">canvas</span> <span class="token punctuation">{</span>
        <span class="token property">width</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span>
        <span class="token property">height</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tutorial<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>150<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>150<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>请升级最新浏览器<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>Canvas <strong>元素及画布</strong>的默认大小为一致，且为 300像素×150像素（宽×高，像素的单位是px），可通过 css 样式去改变 canvas 元素在页面布局的大小，画布内容会自适应元素大小</p> <p><img src="/assets/img/iShot2020-07-08pm11.20.08.1cfac26b.png" alt=""></p> <p>上面案例中，我们画布大小为 150 * 150，元素大小 300 * 300，最后图像自适应填充了整个元素大小</p> <blockquote><p>注意：如果CSS的尺寸与初始画布的比例不一致，它会出现扭曲</p></blockquote> <h3 id="坐标系"><a href="#坐标系" class="header-anchor">#</a> 坐标系</h3> <p>在画布中所有元素的位置都是在按照以左上角位置为原点（0，0），y 轴向下的坐标系中</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANwAAADcCAMAAAAshD+zAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAABgUExURQAAACYmJn5+fry8vOrq6kNDQ9zc3I6Ojm5ubp2dna2trVtbW87OzsjIyO/v7////zJfofb29v7+/uXl5ff39/39/fj4+Pz8/Pn5+fr6+szMzPv7+6enp+fn59DQ0PT09O486JcAAAQQSURBVHja7N2JjtowEAZgXzPkIi5H2wANvP9b1uFYtZtAE661p/8v8GqjCPxp7JhYK1Z5wVHAAQcccMABB5wAXON4v004e3bNNdyB2R0WCefgmA/DuIbbRfJpuRnEOV4ICLtBHDsJOMeDuP1BAu6wH8RtFyKyBS5ceoiolYqj+WJOQnFtB0uudCNx1oTGWKG4LDSZUNxCn58icXlpy1zsOmeTm3EjcOkscG0YWXY+CZfQAkfz9u86XMGtL2kpNNSuUwiTyf868C+cNaExNjQqWpS6dM3QehouC01mu1eIOsfOlnoabq3Pz/XQ5tjq9jE18rz7j/36s3KWZmYa7rjAxY27hHit20m4MOvs+j5cGC3vxBXmPIsm4D6mbey4fl6Je/ewBA444IADDjjggAMOOOCAux+36qe6fUyNPO/+Y6gccCPfmCvvaxsx7kc/43Gq9qZ8E+7HrbwA50vjNUvFsZqRl4rzpbJycTl5uThdyMVZ7eXiTCEY985PKMABBxxwwAH3JFyUeyio3L24uqi9raTOubKsdGK4pp8ruFqr/AuHZXMrD+P8TNdicYUqtVRcpaow7YY7844/j3pt5erjQyjui9e5J+KUGv3G3akJ4abn2/2Jv3Jp4SYOI+CAAw444IThpu95PIAbu4fyP1RuLheXG21CeCRu00+cuGPXLrjPXRaBuxbg4seZ7g7LCsVpJ7hyJHVYZkSkdWi2AnFbe47D1RK4qHCn3bbPs04ILrObLW0siV0KjN3IxGneOGKnReIKTcrkqpB5tXSWN+ywFAziotxDOY5JszFTblZ3/cRZua5nhdmdcJ+7LAF3NcDFj2NSnEnFkaUdSZ1zgbYzVm7lWDuhuC0pXeBqCVxcuIK63S+hOF10u19ilwKhwzIPn5l1KfSDc27OwV2BdNzPfuLE/bwV4E64KPdQUDnggAMOOOCAA24i7vXHgAMOOOCAexnuez9x4r7fCnD/Ae5V32ny0PehoHLAAQcccMABBxxwwAEHHHDAicAt+4kTt7wV4E64KPdQUDnggAMOOOCA+zfuV4x5Fm6ZXIADbmKsPf00MeCUepLugjKvHxBvx1Wq+sDlHAnu2b3ocGRF4Gx2nF35LIjCrzMqMxOKqMPLGjJfj3ssimtVLPWpVDnVrC+Vs7XmxHGmnGnK6TQCOtQfw5Js4rha6Up3hes0Zb5cZvHgwlxZcvFQ6ah7nHBWF7mKCNd1pXqodMWyzi+rNpu8W8S7peC8IrwT17vJoNpmPrWMxdny03+okYTzZe7l4owFDrjocCkGOOCAiwG330mw7faDOK4l4GoexLmVBNzKDeIadunbHDeDOH/gVZ30vNvVKz74YZxvHO+3CWfPrvHXcNICHHDAAQcccMAlmt8CDABIbErQtEaWvQAAAABJRU5ErkJggg==" alt=""></p> <h3 id="绘制路径"><a href="#绘制路径" class="header-anchor">#</a> 绘制路径</h3> <p>路径是有一条或多条直线、曲线形成；而图形都是通过一条或者多条路径组合而成的，CanvasRenderingContext2D 只提供 rect 矩形绘制的 api（fillRect、strokeRect），其他复杂的图形需要我们自己绘制路径形成：</p> <ol><li><p>beginPath 声明开始创建路径</p> <p>路径是由很多子路径构成，这些子路径都是在一个<strong>列表</strong>中，所有的子路径（线、弧形、等等）构成图形。而每次这个方法调用之后，列表清空重置，然后我们就可以重新绘制新的图形</p></li> <li><p>moveTo 确定路径起点</p></li> <li><p>调用路径绘制指令</p> <p>调用绘制路径的函数（如 lineTo、arcTo 等）生成子路径，<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D#%E8%B7%AF%E5%BE%84" target="_blank" rel="noopener noreferrer">CanvasRenderingContext2D 路径方法列表<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p>closePath 闭合路径（可选）</p> <p>closePath 会通过绘制一条从当前点到开始点的直线来闭合图形。以 fill 填充方式绘制路径，会自动闭合</p></li> <li><p>使用 stroke 描边和 fill 填充的方式将路径绘制到画布中</p></li></ol> <p>其中最主要的也是 1、3、5 步骤</p> <h2 id="绘制图像"><a href="#绘制图像" class="header-anchor">#</a> 绘制图像</h2> <h3 id="裁剪、合成"><a href="#裁剪、合成" class="header-anchor">#</a> 裁剪、合成</h3> <h2 id="动画"><a href="#动画" class="header-anchor">#</a> 动画</h2> <h2 id="canvas-高清适配"><a href="#canvas-高清适配" class="header-anchor">#</a> Canvas 高清适配</h2> <hr> <!----></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.38b0ed3c.js" defer></script><script src="/assets/js/2.baa3e7d6.js" defer></script><script src="/assets/js/11.01908082.js" defer></script>
  </body>
</html>
