微前端，就是把单一应用拆分成多个独立应用，再聚合成单一应用。

在微前端方法中，应用程序由不同的，独立的微应用程序组成，每个应用程序负责特定的功能，并且可以由不同的团队分别开发和部署。

## Why Not Iframe

- CSS 问题（视窗大小不同步）
- url 同步问题
- 子应用通信（使用postMessage并不友好）
- 组件不能共享
- 使用创建 iframe，可能会对性能或者内存造成影响

https://www.yuque.com/kuitos/gky7yw/gesexv

## 微前端核心设计

### 沙箱机制

- JS 作用域隔离
- CSS 样式隔离

- qiankun

  qiankun 实际上是**微前端的运行时容器**

  - 应用生命周期管理

    - 加载
      - 对接协议
      - HTML Entry
    - 装载
    - 卸载

  - 隔离

    - JS 沙箱

      - window diff
      - window proxy 记录操作
      - window proxy 代理操作

    - CSS 隔离
      
      - 工程角度
      
        ![图片](${images}/640)
      
      - Shadow DOM
      
      - web component
      
        - https://lit-element.polymer-project.org/guide
        - https://lit.dev/

  - 通信

    - 基于 URL

    - #### 发布/订阅模型

    - window 的 `CustomEvent`